# **Force Windows to Globally Prioritize IPv6 Connections**  

<p style="font-size: smaller; color: gray;"><a href="./IPv6First">ÁÆÄ‰Ωì‰∏≠Êñá</a> / English / <a href="./index-EN">Back to README</a></p>

> [!NOTE]  
> This document is summarized and generated by DeepSeek  

To make Windows **prioritize IPv6 for all network connections** (including `ping`, browsers, games, etc.), follow these steps:  

> Alternatively, use the [one-click priority boost script](https://github.com/MiaowCham/How_to_connect_Spotify_with_IPv6/releases/latest)  

---  

## **üìå Core Steps (Recommended)**  
### **1. Modify IPv6 Prefix Policies (Enforce Priority)**  
**Run CMD/PowerShell as Administrator** and execute:  
```cmd  
netsh interface ipv6 set prefixpolicy ::/0 100 0 persistent  
netsh interface ipv6 set prefixpolicy ::ffff:0:0/96 40 1 persistent  
netsh interface ipv6 set global randomizeidentifiers=disabled  
netsh interface ipv6 set global randomizeidentifiers=enabled  
```  
- **`::/0`**: Represents all IPv6 addresses. Set priority to **100** (highest).  
- **`::ffff:0:0/96`**: Represents IPv4-mapped addresses. Set priority to **40** (lower than IPv6).  
- Lines 3-4 reload IPv6 configurations to apply changes immediately.  

### **2. Verify Configuration**  
```cmd  
netsh interface ipv6 show prefixpolicies  
```  
- Check the output to ensure `::/0` has a **Precedence** of **100** and appears before `::ffff:0:0/96`.  

### **3. Validate Connectivity**  
1. Open **Command Prompt** (`Win + R` ‚Üí `cmd` ‚Üí Enter).  
2. Run:  
    ```cmd  
    ping api.spotify.com  
    ping accounts.spotify.com  
    ```  
    If IPv6 responses are received **without** the `-6` flag, the configuration is successful.  

---  

## **üîç Additional Optimization (Optional)**  

### **4. Check DNS Resolution Order**  
```cmd  
nslookup spotify.com  
```  
- If IPv6 (AAAA records) are listed before IPv4 (A records), DNS prioritization is active.  

### **5. Test `ping` and `curl`**  
```cmd  
ping api.spotify.com          # Should return IPv6 addresses  
curl -v https://api.spotify.com  # Should use IPv6 connections  
```  

---  

## **‚ùì Frequently Asked Questions**  
### **Q1: Why does `ping` still use IPv4?**  
- Possible reasons:  
  - The target website lacks IPv6 (AAAA records).  
  - Local firewall/ISP blocks IPv6 ICMP requests.  
  - DNS cache is outdated (try `ipconfig /flushdns`).  

### **Q2: How to restore default settings?**  
```cmd  
netsh interface ipv6 reset  
```  
- All settings revert to default after a system reboot.  
- You must reapply configurations after rebooting.  